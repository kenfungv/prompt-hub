# 拖拉式 Prompt Builder 設計文檔

## 📋 概述

Prompt Builder 是一個視覺化的拖拉式編輯器，允許用戶通過組合不同類型的區塊來構建結構化的 AI prompts。該工具提供直觀的用戶界面，支持拖放操作、即時預覽和靈活的區塊管理。

## 🎯 功能特性

### 核心功能

1. **拖拉式區塊系統**
   - 支持五種區塊類型：文本、變量、指令、範例、條件
   - 區塊可自由拖動排序
   - 支持區塊的添加、編輯和刪除

2. **區塊類型**
   - **TEXT（文本）**: 基礎文本內容，藍色標識
   - **VARIABLE（變量）**: 動態變量插入，橙色標識
   - **INSTRUCTION（指令）**: 明確的指令說明，紫色標識
   - **EXAMPLE（範例）**: 示例內容，綠色標識
   - **CONDITION（條件）**: 條件邏輯，紅色標識

3. **實時預覽**
   - 自動生成格式化的 prompt
   - 支持複製到剪貼簿
   - 區塊內容即時更新

4. **保存與管理**
   - 命名 prompt
   - 保存到數據庫（待後端集成）
   - 區塊配置持久化

## 🏗️ 技術架構

### 技術棧

- **React 18.2**: 主框架
- **React DnD 16.0**: 拖放功能實現
- **HTML5 Backend**: 拖放後端支持
- **CSS3**: 響應式樣式設計

### 組件結構

```
PromptBuilder (主組件)
├── BlockPalette (區塊模板選擇器)
│   └── Template Buttons (模板按鈕)
├── Canvas Area (拖拉區域)
│   └── DraggableBlock[] (可拖動區塊列表)
│       ├── Block Header (區塊標頭)
│       ├── Block Content (區塊內容)
│       └── Remove Button (刪除按鈕)
└── Preview Panel (預覽面板)
    ├── Preview Content (預覽內容)
    └── Action Buttons (操作按鈕)
```

### 數據流

```
用戶操作 → State 更新 → 組件重渲染 → UI 更新
   ↓
生成 Prompt → 預覽顯示 → 保存/複製
```

## 🎨 用戶界面設計

### 布局結構

```
+--------------------------------------------------+
|              Header (標題 + Prompt名稱)            |
+--------------------------------------------------+
|         |                      |                 |
| 左側邊欄 |     中間畫布區域      |   右側預覽面板   |
| (模板)   |   (拖拉式區塊)       |   (生成結果)     |
|         |                      |                 |
| [模板1] |  [區塊1]             |  預覽內容       |
| [模板2] |  [區塊2]             |                 |
| [模板3] |  [區塊3]             |  [保存按鈕]     |
| [模板4] |                      |  [複製按鈕]     |
| [模板5] |                      |                 |
|         |                      |                 |
| [生成]  |                      |                 |
| [清空]  |                      |                 |
+--------------------------------------------------+
```

### 顏色規範

- **主色調**: 綠色 (#4CAF50) - 成功/確認操作
- **危險色**: 紅色 (#F44336) - 刪除/警告操作
- **信息色**: 藍色 (#2196F3) - 保存/信息操作
- **背景色**: 漸變灰 (#f5f7fa → #c3cfe2)
- **區塊邊框**:
  - 文本: #2196F3 (藍)
  - 變量: #FF9800 (橙)
  - 指令: #9C27B0 (紫)
  - 範例: #4CAF50 (綠)
  - 條件: #F44336 (紅)

## 💻 使用方法

### 基本工作流程

1. **開始構建**
   - 輸入 Prompt 名稱
   - 從左側模板選擇器選擇區塊類型

2. **組織區塊**
   - 拖動區塊調整順序
   - 編輯區塊內容
   - 刪除不需要的區塊

3. **生成與保存**
   - 點擊「生成 Prompt」查看結果
   - 在預覽面板查看格式化輸出
   - 複製到剪貼簿或保存到數據庫

### 區塊格式化規則

```javascript
文本塊 → 原始文本
變量塊 → [變量內容]
指令塊 → ## 指令內容
範例塊 → Example: 範例內容
條件塊 → IF 條件內容
```

## 🔧 API 接口設計

### 保存 Prompt

```javascript
POST /api/prompts
{
  "name": "Prompt 名稱",
  "blocks": [
    {
      "id": 1635789123456,
      "type": "text",
      "content": "區塊內容"
    }
  ],
  "generatedPrompt": "最終生成的 prompt 文本",
  "createdAt": "2025-10-28T00:00:00.000Z"
}
```

### 獲取已保存的 Prompts

```javascript
GET /api/prompts
Response: [
  {
    "id": "uuid",
    "name": "Prompt 名稱",
    "blocks": [...],
    "generatedPrompt": "...",
    "createdAt": "...",
    "updatedAt": "..."
  }
]
```

### 更新 Prompt

```javascript
PUT /api/prompts/:id
{
  "name": "更新的名稱",
  "blocks": [...],
  "generatedPrompt": "..."
}
```

### 刪除 Prompt

```javascript
DELETE /api/prompts/:id
```

## 📱 響應式設計

### 斷點設計

- **桌面 (> 1400px)**: 三欄布局
- **平板 (1200px - 1400px)**: 窄三欄布局
- **移動設備 (< 1200px)**: 單欄垂直布局
- **小型移動設備 (< 768px)**: 優化的觸摸界面

## 🚀 未來優化方向

### 短期計劃

1. **後端集成**
   - 完成 API 對接
   - 實現數據持久化
   - 添加用戶認證

2. **功能增強**
   - 區塊模板庫擴展
   - 支持區塊嵌套
   - 添加撤銷/重做功能

3. **用戶體驗**
   - 添加鍵盤快捷鍵
   - 區塊搜索功能
   - 批量操作支持

### 長期計劃

1. **協作功能**
   - 多用戶同時編輯
   - 版本控制
   - 評論與討論

2. **AI 輔助**
   - 智能建議區塊
   - 自動優化 prompt
   - 效果預測

3. **導入導出**
   - 支持 JSON/YAML 格式
   - 批量導入
   - 分享鏈接生成

## 🐛 已知問題

1. 拖放操作在某些移動設備上可能不夠流暢
2. 大量區塊時性能可能下降
3. 複雜嵌套結構尚未支持

## 📝 開發日誌

### v1.0.0 (2025-10-28)

- ✅ 初始版本發布
- ✅ 實現拖拉式區塊系統
- ✅ 添加五種基礎區塊類型
- ✅ 實現實時預覽功能
- ✅ 完成響應式設計
- ✅ 添加依賴包配置
- 🔄 待辦：後端 API 集成

## 📚 相關文件

- `frontend/components/PromptBuilder.jsx` - 主組件
- `frontend/components/PromptBuilder.css` - 樣式文件
- `frontend/package.json` - 依賴配置

## 👥 貢獻指南

歡迎貢獻代碼！請遵循以下步驟：

1. Fork 專案
2. 創建特性分支 (`git checkout -b feature/AmazingFeature`)
3. 提交更改 (`git commit -m 'Add some AmazingFeature'`)
4. 推送到分支 (`git push origin feature/AmazingFeature`)
5. 開啟 Pull Request

## 📄 授權

本專案採用 MIT 授權條款。

---

**最後更新**: 2025-10-28  
**維護者**: Prompt Hub Team
